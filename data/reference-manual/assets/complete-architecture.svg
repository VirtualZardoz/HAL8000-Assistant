<svg xmlns="http://www.w3.org/2000/svg" viewBox="-50 0 1200 950">
  <!-- Title -->
  <text x="550" y="40" font-size="32" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
    HAL8000 System Architecture
  </text>
  <text x="550" y="70" font-size="16" text-anchor="middle" fill="#666" font-style="italic">
    Modified von Neumann Architecture
  </text>

  <!-- CPU Container -->
  <g id="cpu">
    <rect x="80" y="110" width="420" height="300" fill="#e3f2fd" rx="12" stroke="#1976d2" stroke-width="3"/>
    <text x="290" y="145" font-size="24" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
      CPU (Claude Instance)
    </text>

    <!-- Control Unit -->
    <rect x="110" y="170" width="180" height="90" fill="#bbdefb" rx="8" stroke="#1976d2" stroke-width="2"/>
    <text x="200" y="200" font-size="16" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
      Control Unit
    </text>
    <text x="200" y="225" font-size="12" text-anchor="middle" fill="#424242">
      Orchestration &amp;
    </text>
    <text x="200" y="243" font-size="12" text-anchor="middle" fill="#424242">
      Decision Making
    </text>

    <!-- ALU -->
    <rect x="310" y="170" width="180" height="90" fill="#bbdefb" rx="8" stroke="#1976d2" stroke-width="2"/>
    <text x="400" y="200" font-size="16" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
      ALU
    </text>
    <text x="400" y="225" font-size="12" text-anchor="middle" fill="#424242">
      Reasoning &amp;
    </text>
    <text x="400" y="243" font-size="12" text-anchor="middle" fill="#424242">
      Computation
    </text>

    <!-- Registers -->
    <rect x="110" y="285" width="380" height="105" fill="#bbdefb" rx="8" stroke="#1976d2" stroke-width="2"/>
    <text x="300" y="312" font-size="16" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
      Register Bank
    </text>
    <text x="150" y="338" font-size="11" text-anchor="start" fill="#1a1a1a">
      • CPU_STATUS
    </text>
    <text x="150" y="355" font-size="11" text-anchor="start" fill="#1a1a1a">
      • RAM_ZONE
    </text>
    <text x="150" y="372" font-size="11" text-anchor="start" fill="#1a1a1a">
      • ERROR_FLAG
    </text>
    <text x="320" y="338" font-size="11" text-anchor="start" fill="#1a1a1a">
      • PC (Program Counter)
    </text>
    <text x="320" y="355" font-size="11" text-anchor="start" fill="#1a1a1a">
      • LAST_SESSION
    </text>
    <text x="320" y="372" font-size="11" text-anchor="start" fill="#1a1a1a">
      • CONTEXT_MANIFEST
    </text>
  </g>

  <!-- RAM -->
  <g id="ram">
    <rect x="80" y="460" width="420" height="120" fill="#f3e5f5" rx="12" stroke="#7b1fa2" stroke-width="3"/>
    <text x="290" y="505" font-size="24" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
      RAM (Context Window)
    </text>
    <text x="290" y="535" font-size="14" text-anchor="middle" fill="#424242">
      200,000 tokens (volatile)
    </text>
    <text x="290" y="560" font-size="12" text-anchor="middle" fill="#666" font-style="italic">
      Append-only during session
    </text>
  </g>

  <!-- Storage -->
  <g id="storage">
    <rect x="80" y="630" width="420" height="120" fill="#e8f5e9" rx="12" stroke="#388e3c" stroke-width="3"/>
    <text x="290" y="675" font-size="24" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
      Storage (File System)
    </text>
    <text x="290" y="705" font-size="14" text-anchor="middle" fill="#424242">
      /mnt/d/~HAL8000/ (persistent)
    </text>
    <text x="290" y="730" font-size="12" text-anchor="middle" fill="#666" font-style="italic">
      Commands, Data, State, Sessions
    </text>
  </g>

  <!-- System Buses (Center) -->
  <g id="buses">
    <rect x="560" y="280" width="200" height="240" fill="#fff3e0" rx="12" stroke="#f57c00" stroke-width="3"/>
    <text x="660" y="315" font-size="22" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
      System Buses
    </text>

    <!-- Data Bus -->
    <rect x="580" y="340" width="160" height="50" fill="#ffe0b2" rx="6" stroke="#f57c00" stroke-width="2"/>
    <text x="660" y="363" font-size="14" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
      Data Bus
    </text>
    <text x="660" y="381" font-size="11" text-anchor="middle" fill="#424242">
      File Content
    </text>

    <!-- Address Bus -->
    <rect x="580" y="405" width="160" height="50" fill="#ffe0b2" rx="6" stroke="#f57c00" stroke-width="2"/>
    <text x="660" y="428" font-size="14" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
      Address Bus
    </text>
    <text x="660" y="446" font-size="11" text-anchor="middle" fill="#424242">
      File Paths
    </text>

    <!-- Control Bus -->
    <rect x="580" y="470" width="160" height="50" fill="#ffe0b2" rx="6" stroke="#f57c00" stroke-width="2"/>
    <text x="660" y="493" font-size="14" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
      Control Bus
    </text>
    <text x="660" y="511" font-size="11" text-anchor="middle" fill="#424242">
      Read/Write Ops
    </text>
  </g>

  <!-- I/O System -->
  <g id="io">
    <rect x="820" y="280" width="280" height="240" fill="#ffebee" rx="12" stroke="#c62828" stroke-width="3"/>
    <text x="960" y="315" font-size="22" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
      I/O System
    </text>

    <!-- Built-in Tools -->
    <rect x="840" y="340" width="240" height="70" fill="#ffcdd2" rx="6" stroke="#c62828" stroke-width="2"/>
    <text x="960" y="363" font-size="14" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
      Built-in Tools
    </text>
    <text x="960" y="385" font-size="11" text-anchor="middle" fill="#424242">
      Read, Write, Edit, Grep,
    </text>
    <text x="960" y="401" font-size="11" text-anchor="middle" fill="#424242">
      Glob, Bash, Task
    </text>

    <!-- MCP Servers -->
    <rect x="840" y="425" width="240" height="85" fill="#ffcdd2" rx="6" stroke="#c62828" stroke-width="2"/>
    <text x="960" y="448" font-size="14" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
      MCP Servers
    </text>
    <text x="960" y="470" font-size="11" text-anchor="middle" fill="#424242">
      omnisearch: Web search
    </text>
    <text x="960" y="486" font-size="11" text-anchor="middle" fill="#424242">
      filesystem: Enhanced I/O
    </text>
    <text x="960" y="502" font-size="11" text-anchor="middle" fill="#424242">
      External programs
    </text>
  </g>

  <!-- BIOS/Boot -->
  <g id="bios">
    <rect x="80" y="800" width="420" height="100" fill="#fff8e1" rx="12" stroke="#f9a825" stroke-width="3"/>
    <text x="290" y="840" font-size="22" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
      BIOS (CLAUDE.md)
    </text>
    <text x="290" y="870" font-size="13" text-anchor="middle" fill="#424242">
      Boot instructions, always loaded into RAM at startup
    </text>
  </g>

  <!-- Data Flow Arrows with improved visibility -->
  <!-- CPU <-> RAM (bidirectional) -->
  <path d="M 280 410 L 280 460" stroke="#7b1fa2" stroke-width="4" fill="none" marker-end="url(#arrow-purple)"/>
  <path d="M 310 460 L 310 410" stroke="#7b1fa2" stroke-width="4" fill="none" marker-end="url(#arrow-purple)"/>
  <text x="330" y="440" font-size="12" fill="#7b1fa2" font-weight="bold">Load/Store</text>

  <!-- RAM <-> Storage (bidirectional) -->
  <path d="M 280 580 L 280 630" stroke="#388e3c" stroke-width="4" fill="none" marker-end="url(#arrow-green)"/>
  <path d="M 310 630 L 310 580" stroke="#388e3c" stroke-width="4" fill="none" marker-end="url(#arrow-green)"/>
  <text x="330" y="610" font-size="12" fill="#388e3c" font-weight="bold">Read/Write</text>

  <!-- CPU -> Buses -->
  <path d="M 500 260 L 560 365" stroke="#f57c00" stroke-width="4" fill="none" marker-end="url(#arrow-orange)"/>

  <!-- Buses -> I/O -->
  <path d="M 760 400 L 820 400" stroke="#c62828" stroke-width="4" fill="none" marker-end="url(#arrow-red)"/>

  <!-- BIOS -> RAM (Boot) -->
  <path d="M 200 800 L 200 580" stroke="#f9a825" stroke-width="3" fill="none" stroke-dasharray="8,5" marker-end="url(#arrow-yellow)"/>
  <text x="150" y="690" font-size="11" fill="#f9a825" font-weight="bold">Boot Load</text>

  <!-- Arrow markers with better visibility -->
  <defs>
    <marker id="arrow-purple" markerWidth="12" markerHeight="12" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 12 3.5, 0 7" fill="#7b1fa2"/>
    </marker>
    <marker id="arrow-green" markerWidth="12" markerHeight="12" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 12 3.5, 0 7" fill="#388e3c"/>
    </marker>
    <marker id="arrow-orange" markerWidth="12" markerHeight="12" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 12 3.5, 0 7" fill="#f57c00"/>
    </marker>
    <marker id="arrow-red" markerWidth="12" markerHeight="12" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 12 3.5, 0 7" fill="#c62828"/>
    </marker>
    <marker id="arrow-yellow" markerWidth="12" markerHeight="12" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 12 3.5, 0 7" fill="#f9a825"/>
    </marker>
  </defs>

  <!-- Enhanced Legend Box -->
  <g id="legend">
    <rect x="560" y="780" width="540" height="90" fill="#fafafa" rx="8" stroke="#bdbdbd" stroke-width="2"/>
    <text x="830" y="808" font-size="14" font-weight="bold" fill="#1a1a1a" text-anchor="middle">Data Flow Legend</text>

    <!-- Row 1 -->
    <line x1="590" y1="830" x2="640" y2="830" stroke="#7b1fa2" stroke-width="3"/>
    <text x="650" y="835" font-size="12" fill="#424242">CPU ↔ RAM</text>

    <line x1="760" y1="830" x2="810" y2="830" stroke="#388e3c" stroke-width="3"/>
    <text x="820" y="835" font-size="12" fill="#424242">RAM ↔ Storage</text>

    <line x1="950" y1="830" x2="1000" y2="830" stroke="#f57c00" stroke-width="3"/>
    <text x="1010" y="835" font-size="12" fill="#424242">System Bus</text>

    <!-- Row 2 -->
    <line x1="590" y1="855" x2="640" y2="855" stroke="#c62828" stroke-width="3"/>
    <text x="650" y="860" font-size="12" fill="#424242">I/O Connection</text>

    <line x1="790" y1="855" x2="840" y2="855" stroke="#f9a825" stroke-width="3" stroke-dasharray="8,5"/>
    <text x="850" y="860" font-size="12" fill="#424242">Boot Load</text>
  </g>
</svg>