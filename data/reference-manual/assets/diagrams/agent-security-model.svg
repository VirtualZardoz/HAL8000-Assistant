<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 650" width="900" height="650">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; text-anchor: middle; fill: #2c3e50; }
      .label { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; text-anchor: middle; }
      .desc { font-family: Arial, sans-serif; font-size: 12px; text-anchor: middle; fill: #666; }
      .principle { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; text-anchor: middle; fill: #e74c3c; }
    </style>
  </defs>

  <!-- Title -->
  <text x="450" y="40" class="title">Agent Security Model: Tool Whitelisting</text>

  <!-- Outer Circle - All Available Tools (blocked) -->
  <circle cx="450" cy="350" r="250" fill="#ffebee" stroke="#e57373" stroke-width="3" opacity="0.7"/>
  <text x="450" y="105" class="label" fill="#c62828">All Available Tools</text>
  <text x="450" y="125" class="desc">(Blocked by default)</text>

  <!-- Tool labels around outer circle -->
  <text x="170" y="215" class="desc" fill="#999">❌ TodoWrite</text>
  <text x="140" y="360" class="desc" fill="#999">❌ NotebookEdit</text>
  <text x="200" y="500" class="desc" fill="#999">❌ WebFetch</text>
  <text x="730" y="215" class="desc" fill="#999">❌ SlashCommand</text>
  <text x="760" y="360" class="desc" fill="#999">❌ BashOutput</text>
  <text x="700" y="500" class="desc" fill="#999">❌ KillShell</text>

  <!-- Middle Circle - Whitelisted Tools -->
  <circle cx="450" cy="350" r="160" fill="#fff9c4" stroke="#fbc02d" stroke-width="4"/>
  <text x="450" y="195" class="label" fill="#f57f17">Whitelisted Tools</text>
  <text x="450" y="215" class="desc">(Explicit permissions)</text>

  <!-- Whitelisted tool labels -->
  <text x="340" y="280" class="desc" fill="#f57f17">✓ Read</text>
  <text x="560" y="280" class="desc" fill="#f57f17">✓ Grep</text>
  <text x="340" y="415" class="desc" fill="#f57f17">✓ Glob</text>
  <text x="560" y="415" class="desc" fill="#f57f17">✓ search_files</text>

  <!-- Inner Circle - Agent -->
  <circle cx="450" cy="350" r="70" fill="#c8e6c9" stroke="#43a047" stroke-width="4"/>
  <text x="450" y="345" class="label" fill="#1b5e20">Agent</text>
  <text x="450" y="365" class="desc" fill="#2e7d32">(Restricted</text>
  <text x="450" y="380" class="desc" fill="#2e7d32">process)</text>

  <!-- Arrows showing access -->
  <defs>
    <marker id="access-arrow" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
      <polygon points="0 0, 8 4, 0 8" fill="#43a047" />
    </marker>
    <marker id="block-arrow" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
      <polygon points="0 0, 8 4, 0 8" fill="#e57373" />
    </marker>
  </defs>

  <!-- Access arrows (agent can access whitelisted) -->
  <line x1="410" y1="310" x2="360" y2="285" stroke="#43a047" stroke-width="2" marker-end="url(#access-arrow)"/>
  <line x1="490" y1="310" x2="540" y2="285" stroke="#43a047" stroke-width="2" marker-end="url(#access-arrow)"/>

  <!-- Block arrows (agent cannot access non-whitelisted) -->
  <line x1="370" y1="320" x2="240" y2="245" stroke="#e57373" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#block-arrow)"/>
  <text x="295" y="275" style="font-size: 10px; fill: #c62828;">✗ Blocked</text>

  <!-- Principle label at bottom -->
  <rect x="250" y="590" width="400" height="50" fill="#ffebee" stroke="#e74c3c" stroke-width="2" rx="5"/>
  <text x="450" y="620" class="principle">Principle of Least Privilege</text>
</svg>
